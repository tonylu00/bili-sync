# å¿«é€Ÿå¼€å§‹

> [!IMPORTANT]
> **é¡¹ç›®æ¥æºè¯´æ˜**
> 
> æœ¬é¡¹ç›® (`qq1582185982/bili-sync-01`) æ˜¯ä»åŸä½œè€… [amtoaer/bili-sync](https://github.com/amtoaer/bili-sync) çš„é¡¹ç›® `fork` å¹¶è¿›è¡Œå¤§é‡æ›´æ–°å’Œä¼˜åŒ–çš„ç‰ˆæœ¬ã€‚æˆ‘ä»¬å¯¹åŸä½œè€…çš„è´¡çŒ®è¡¨ç¤ºæ„Ÿè°¢ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸ŠæŒç»­è¿­ä»£ã€‚

ç¨‹åºä½¿ç”¨ Rust ç¼–å†™ï¼Œä¸éœ€è¦ Runtime ä¸”å¹¶ä¸ºå„ä¸ªå¹³å°æä¾›äº†é¢„ç¼–è¯‘æ–‡ä»¶ï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯æ²¡æœ‰ä½¿ç”¨éšœç¢çš„ã€‚

> [!TIP]
> **v2.6.2 é‡å¤§å˜æ›´**ï¼šè§†é¢‘æºé…ç½®å·²å®Œå…¨è¿ç§»åˆ°æ•°æ®åº“ç®¡ç†ï¼ç°åœ¨é€šè¿‡ Web ç•Œé¢æ·»åŠ å’Œç®¡ç†è§†é¢‘æºï¼Œæ— éœ€æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶ã€‚

> [!IMPORTANT]
> å¦‚æœæ‚¨ä»æ—§ç‰ˆæœ¬å‡çº§ï¼Œè¯·æŸ¥çœ‹ [é…ç½®è¿ç§»æŒ‡å—](./MIGRATION_GUIDE)ã€‚

## ğŸš€ å¼€å‘ç¯å¢ƒå¿«é€Ÿè®¾ç½®

å¦‚æœæ‚¨æƒ³å‚ä¸å¼€å‘æˆ–ä»æºç æ„å»ºï¼Œæ¨èä½¿ç”¨æˆ‘ä»¬çš„ä¸€é”®è®¾ç½®ï¼š

### Windows ç”¨æˆ·ï¼ˆæ¨èï¼‰
```bash
# ä¸€é”®è®¾ç½®å¼€å‘ç¯å¢ƒ
.\make.bat setup

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
.\make.bat dev

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
.\make.bat help
```

### å…¶ä»–å¹³å°æˆ–ä¼ ç»Ÿæ–¹å¼
```bash
# ç¡®ä¿å®‰è£…äº† Rust å’Œ Node.js
cargo --version
node --version

# å®‰è£…å‰ç«¯ä¾èµ–
cd web && npm install && cd ..

# æ„å»ºå‰ç«¯
cd web && npm run build && cd ..

# è¿è¡Œç¨‹åº
cargo run --bin bili-sync-rs
```

## ç¨‹åºè·å–

ç¨‹åºä¸ºå„ä¸ªå¹³å°æä¾›äº†é¢„æ„å»ºçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸”æ‰“åŒ…äº† `Linux/amd64` ä¸ `Linux/arm64` ä¸¤ä¸ªå¹³å°çš„ Docker é•œåƒã€‚ç”¨æˆ·å¯ä»¥è‡ªè¡Œé€‰æ‹©ä½¿ç”¨å“ªç§æ–¹å¼è¿è¡Œã€‚

### å…¶ä¸€ï¼šä¸‹è½½å¹³å°äºŒè¿›åˆ¶æ–‡ä»¶è¿è¡Œ

> [!CAUTION]
> å¦‚æœä½ ä½¿ç”¨è¿™ç§æ–¹å¼è¿è¡Œï¼Œè¯·ç¡®ä¿ FFmpeg å·²è¢«æ­£ç¡®å®‰è£…ä¸”ä½äº PATH ä¸­ï¼Œå¯é€šè¿‡æ‰§è¡Œ `ffmpeg` å‘½ä»¤è®¿é—®ã€‚

åœ¨[ç¨‹åºå‘å¸ƒé¡µ](https://github.com/qq1582185982/bili-sync-01/releases)é€‰æ‹©æœ€æ–°ç‰ˆæœ¬ä¸­å¯¹åº”æœºå™¨æ¶æ„çš„å‹ç¼©åŒ…ï¼Œè§£å‹åä¼šè·å–ä¸€ä¸ªåä¸º `bili-sync-rs` çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç›´æ¥åŒå‡»æ‰§è¡Œã€‚

### å…¶äºŒï¼š ä½¿ç”¨ Docker Compose è¿è¡Œ

Linux/amd64 ä¸ Linux/arm64 ä¸¤ä¸ªå¹³å°å¯ç›´æ¥ä½¿ç”¨ Docker æˆ– Docker Compose è¿è¡Œï¼Œæ­¤å¤„ä»¥ Compose ä¸ºä¾‹ï¼š

> [!TIP]
> **Docker é•œåƒé€‰æ‹©**ï¼šæˆ‘ä»¬æä¾›äº†ä¸¤ä¸ªé•œåƒåœ°å€ä¾›æ‚¨é€‰æ‹©ï¼š
> - **GitHub é•œåƒ**ï¼š`qq1582185982/bili-sync:latest` 
> - **å›½å†…é•œåƒ**ï¼š`docker.cnb.cool/sviplk.com/docker/bili-sync:latest`
> 
> å»ºè®®å›½å†…ç”¨æˆ·ä½¿ç”¨å›½å†…é•œåƒä»¥è·å¾—æ›´å¥½çš„ä¸‹è½½é€Ÿåº¦ã€‚

> è¯·æ³¨æ„å…¶ä¸­çš„æ³¨é‡Šï¼Œæœ‰ä¸æ¸…æ¥šçš„åœ°æ–¹å¯ä»¥å…ˆç»§ç»­å¾€ä¸‹çœ‹ã€‚

```yaml
services:
  bili-sync-rs:
    # æ¨èä½¿ç”¨ä¼˜åŒ–ç‰ˆé•œåƒï¼Œæä¾›æ›´å¥½çš„ç¨³å®šæ€§å’ŒåŠŸèƒ½
    # GitHub é•œåƒï¼ˆå›½å¤–ç”¨æˆ·æ¨èï¼‰
    image: qq1582185982/bili-sync:latest
    # å›½å†…é•œåƒï¼ˆå›½å†…ç”¨æˆ·æ¨èï¼‰
    # image: docker.cnb.cool/sviplk.com/docker/bili-sync:latest
    restart: unless-stopped
    network_mode: bridge
    # è¯¥é€‰é¡¹è¯·ä»…åœ¨æ—¥å¿—ç»ˆç«¯æ”¯æŒå½©è‰²è¾“å‡ºæ—¶å¯ç”¨ï¼Œå¦åˆ™æ—¥å¿—ä¸­å¯èƒ½ä¼šå‡ºç°ä¹±ç 
    tty: true
    # éå¿…éœ€è®¾ç½®é¡¹ï¼Œæ¨èè®¾ç½®ä¸ºå®¿ä¸»æœºç”¨æˆ·çš„ uid åŠ gid (`$uid:$gid`)
    # å¯ä»¥æ‰§è¡Œ `id ${user}` è·å– `user` ç”¨æˆ·çš„ uid åŠ gid
    # ç¨‹åºä¸‹è½½çš„æ‰€æœ‰æ–‡ä»¶æƒé™å°†ä¸æ­¤å¤„çš„ç”¨æˆ·ä¿æŒä¸€è‡´ï¼Œä¸è®¾ç½®é»˜è®¤ä¸º Root
    user: 1000:1000
    hostname: bili-sync-rs
    container_name: bili-sync-rs
    # ç¨‹åºé»˜è®¤ç»‘å®š 0.0.0.0:12345 è¿è¡Œ http æœåŠ¡
    # å¯åŒæ—¶ä¿®æ”¹ compose æ–‡ä»¶ä¸ config.toml å˜æ›´æœåŠ¡è¿è¡Œçš„ç«¯å£
    ports:
      - 12345:12345
    volumes:
      - ${ä½ å¸Œæœ›å­˜å‚¨ç¨‹åºé…ç½®çš„ç›®å½•}:/app/.config/bili-sync
      # è¿˜éœ€è¦æœ‰ä¸€äº›å…¶å®ƒå¿…è¦çš„æŒ‚è½½ï¼ŒåŒ…æ‹¬ up ä¸»ä¿¡æ¯ä½ç½®ã€è§†é¢‘ä¸‹è½½ä½ç½®
      # è¿™äº›ç›®å½•ä¸æ˜¯å›ºå®šçš„ï¼Œåªéœ€è¦ç¡®ä¿æ­¤å¤„çš„æŒ‚è½½ä¸ bili-sync-rs çš„é…ç½®æ–‡ä»¶ç›¸åŒ¹é…
      # ...
    # å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç¾¤æ™–ç³»ç»Ÿï¼Œè¯·ç§»é™¤æœ€åçš„ logging é…ç½®ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ—¥å¿—ä¸æ˜¾ç¤º
    logging:
      driver: "local"
```

ä½¿ç”¨è¯¥ compose æ–‡ä»¶ï¼Œæ‰§è¡Œ `docker compose up -d` å³å¯è¿è¡Œã€‚

## ç¨‹åºé…ç½®

ç¨‹åºé¦–æ¬¡è¿è¡Œæ—¶ï¼Œä¼šåœ¨é…ç½®ç›®å½•ï¼ˆå…·ä½“ä½ç½®è§ä¸‹æ–‡ï¼‰ç”Ÿæˆä¸€ä¸ª `config.toml` æ–‡ä»¶ã€‚æ‚¨éœ€è¦å¯¹è¯¥æ–‡ä»¶è¿›è¡Œå°‘é‡ä¿®æ”¹æ‰èƒ½æˆåŠŸè¿è¡Œç¨‹åºã€‚

> [!IMPORTANT]
> **é‡å¤§å˜æ›´ï¼** è§†é¢‘æºé…ç½®å·²ä» `config.toml` è¿ç§»åˆ°æ•°æ®åº“ï¼š
> - âŒ ä¸å†éœ€è¦åœ¨ `config.toml` ä¸­é…ç½® `favorite_list`ã€`collection_list` ç­‰
> - âœ… æ‰€æœ‰è§†é¢‘æºé€šè¿‡ Web ç®¡ç†ç•Œé¢ `http://127.0.0.1:12345` è¿›è¡Œæ·»åŠ å’Œç®¡ç†

### é…ç½®æ–‡ä»¶ä½ç½®

ç¨‹åºé»˜è®¤ä¼šå°†é…ç½®æ–‡ä»¶å­˜å‚¨äº `${config_dir}/bili-sync/config.toml`ï¼Œæ•°æ®åº“æ–‡ä»¶å­˜å‚¨äº `${config_dir}/bili-sync/data.sqlite`ã€‚

`config_dir` çš„å®é™…ä½ç½®ä¸æ“ä½œç³»ç»Ÿå’Œç”¨æˆ·åæœ‰å…³ã€‚ä¾‹å¦‚å¯¹äºåä¸º Alice çš„ç”¨æˆ·ï¼š

- **Linux**: `/home/Alice/.config`
- **Windows**: `C:\Users\Alice\AppData\Roaming`
- **macOS**: `/Users/Alice/Library/Application Support`
- **Docker**: `/app/.config` (å®¹å™¨å†…è·¯å¾„)

### åŸºç¡€é…ç½®

ä»¥ä¸‹æ˜¯ `config.toml` çš„ä¸€ä¸ªç¤ºä¾‹ï¼Œæ‚¨åªéœ€è¦å…³æ³¨å…¶ä¸­å°‘æ•°å‡ ä¸ªå…³é”®é€‰é¡¹ã€‚

```toml
auth_token = "xxxxxxxx"
bind_address = "0.0.0.0:12345"
video_name = "{{title}}"
page_name = "{{bvid}}"
interval = 1200
upper_path = "/path/to/your/metadata/people" # ä¾‹å¦‚ Emby/Jellyfin çš„å…ƒæ•°æ®è·¯å¾„
nfo_time_type = "favtime"
time_format = "%Y-%m-%d"
cdn_sorting = false

[credential]
sessdata = ""
bili_jct = ""
buvid3 = ""
dedeuserid = ""
ac_time_value = ""

# ... å…¶ä»–é…ç½®é¡¹ä¿æŒé»˜è®¤å³å¯
```

#### å…³é”®é…ç½®é¡¹è¯´æ˜

- **`auth_token`**: è®¿é—® Web UI çš„å¯†ç ï¼Œè¯·åŠ¡å¿…ä¿®æ”¹ä¸ºä¸€ä¸ªå®‰å…¨çš„å­—ç¬¦ä¸²ã€‚
- **`bind_address`**: Web Server ç›‘å¬çš„åœ°å€å’Œç«¯å£ã€‚
- **`interval`**: ç¨‹åºè‡ªåŠ¨æ‰«æåŒæ­¥çš„é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰ã€‚
- **`credential`**: å“”å“©å“”å“©è´¦å·çš„èº«ä»½å‡­æ®ï¼Œæ˜¯è®¿é—®Bç«™APIæ‰€å¿…éœ€çš„ã€‚è¯·å‚è€ƒ[å‡­æ®è·å–æµç¨‹](https://nemo2011.github.io/bilibili-api/#/get-credential)è·å–å¹¶å¡«å†™ã€‚

## Web UI ä½¿ç”¨æŒ‡å—

`bili-sync` æä¾›äº†ä¸€ä¸ªç°ä»£åŒ–çš„ Webç•Œé¢ï¼Œç”¨äºç®¡ç†å’Œç›‘æ§ä¸‹è½½ä»»åŠ¡ã€‚

### è®¿é—® Web UI

å¯åŠ¨ç¨‹åºåï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://<ä½ çš„IPåœ°å€>:12345` å³å¯è®¿é—®ã€‚å¦‚æœæ˜¯æœ¬æœºè¿è¡Œï¼Œåˆ™ä¸º `http://127.0.0.1:12345`ã€‚

é¦–æ¬¡è®¿é—®æ—¶ï¼Œæ‚¨éœ€è¦è¾“å…¥åœ¨ `config.toml` ä¸­è®¾ç½®çš„ `auth_token` è¿›è¡Œèº«ä»½éªŒè¯ã€‚

### ç®¡ç†è§†é¢‘æº

æ‰€æœ‰è§†é¢‘æºï¼ˆå¦‚ä¸‹è½½åˆ—è¡¨ï¼‰çš„ç®¡ç†éƒ½å·²è¿ç§»è‡³ Web UIã€‚

#### æ·»åŠ è§†é¢‘æº

1.  åœ¨ä¾§è¾¹æ ç‚¹å‡» "æ·»åŠ è§†é¢‘æº"ã€‚
2.  é€‰æ‹©æ‚¨æƒ³æ·»åŠ çš„è§†é¢‘æºç±»å‹ã€‚
3.  æ ¹æ®æç¤ºè¾“å…¥å¿…è¦çš„ä¿¡æ¯ï¼Œæˆ–ä½¿ç”¨å†…ç½®çš„æœç´¢åŠŸèƒ½æŸ¥æ‰¾å†…å®¹ã€‚
4.  è®¾ç½®ä¸€ä¸ªåç§°å’Œæœ¬åœ°ä¿å­˜è·¯å¾„ã€‚
5.  ç‚¹å‡»"æ·»åŠ "å³å¯ã€‚

æ”¯æŒçš„è§†é¢‘æºç±»å‹åŠIDè·å–æ–¹å¼å¦‚ä¸‹ï¼š

| ç±»å‹ | è¯´æ˜ | å¦‚ä½•è·å–ID |
| :--- | :--- | :--- |
| **UPä¸»æŠ•ç¨¿** | ä¸‹è½½æŒ‡å®šUPä¸»çš„æ‰€æœ‰è§†é¢‘ | **UPä¸»ID (`uid`)**: è¿›å…¥UPä¸»ç©ºé—´ï¼ŒURLä¸­çš„æ•°å­— (ä¾‹å¦‚ `space.bilibili.com/123456`)ã€‚ |
| **æ”¶è—å¤¹** | ä¸‹è½½æŒ‡å®šæ”¶è—å¤¹çš„æ‰€æœ‰è§†é¢‘ | **æ”¶è—å¤¹ID (`fid`)**: è¿›å…¥æ”¶è—å¤¹é¡µé¢ï¼ŒURLä¸­çš„ `fid` å‚æ•°å€¼ã€‚ |
| **åˆé›†/ç³»åˆ—**| ä¸‹è½½Bç«™çš„è§†é¢‘åˆé›†æˆ–ç³»åˆ— | **åˆé›†/ç³»åˆ—ID**: åœ¨åˆé›†æˆ–ç³»åˆ—æ’­æ”¾é¡µé¢URLä¸­å¯»æ‰¾ `sid` æˆ– `series_id`ã€‚ |
| **ç•ªå‰§** | ä¸‹è½½æŒ‡å®šçš„ç•ªå‰§ | **ç•ªå‰§ID (`season_id`)**: åœ¨ç•ªå‰§æ’­æ”¾é¡µé¢URLä¸­å¯»æ‰¾ `season_id` æˆ– `ss` åé¢çš„æ•°å­—ã€‚ |
| **ç¨åè§‚çœ‹** | åŒæ­¥æ‚¨çš„"ç¨åè§‚çœ‹"åˆ—è¡¨ | æ— éœ€é¢å¤–IDï¼Œè‡ªåŠ¨åŒæ­¥ã€‚ |

> [!TIP]
> æ¨èä½¿ç”¨é¡µé¢å†…çš„ **æœç´¢åŠŸèƒ½**ï¼Œé€šè¿‡å…³é”®è¯æœç´¢è§†é¢‘ã€UPä¸»æˆ–ç•ªå‰§ï¼Œç„¶åç‚¹å‡»é€‰æ‹©ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºæ‚¨å¡«å……å¤§éƒ¨åˆ†ä¿¡æ¯ï¼Œéå¸¸æ–¹ä¾¿ã€‚

#### æŸ¥çœ‹å’Œç®¡ç†

æ‚¨æ·»åŠ çš„æ‰€æœ‰è§†é¢‘æºéƒ½ä¼šåœ¨ "è®¢é˜…ç®¡ç†" é¡µé¢ä»¥å¡ç‰‡å½¢å¼å±•ç¤ºï¼Œæ‚¨å¯ä»¥æ–¹ä¾¿åœ°ï¼š
- æŸ¥çœ‹åŒæ­¥çŠ¶æ€å’Œæœ€è¿‘çš„è§†é¢‘
- æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡åŒæ­¥
- ç¼–è¾‘åç§°å’Œä¿å­˜è·¯å¾„
- åˆ é™¤è§†é¢‘æº

## ä¸‹ä¸€æ­¥

ç°åœ¨æ‚¨å·²ç»åŸºæœ¬äº†è§£äº† `bili-sync` çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥æ·±å…¥æ¢ç´¢æ›´å¤šåŠŸèƒ½äº†ï¼š
- é˜…è¯» [é…ç½®æ–‡ä»¶](./configuration) çš„è¯¦ç»†è¯´æ˜ã€‚
- é˜…è¯»å…·ä½“çš„è§†é¢‘æºç®¡ç†æŒ‡å—ï¼Œä¾‹å¦‚ [æ”¶è—å¤¹ç®¡ç†](./favorite) å’Œ [UPä¸»æŠ•ç¨¿ç®¡ç†](./submission)ã€‚

## è¿è¡Œ

åœ¨é…ç½®æ–‡ä»¶å¡«å†™å®Œæ¯•åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿è¡Œç¨‹åºã€‚å¦‚æœé…ç½®æ–‡ä»¶æ— è¯¯ï¼Œç¨‹åºä¼šè‡ªåŠ¨å¼€å§‹ä¸‹è½½æ”¶è—å¤¹ä¸­çš„è§†é¢‘ã€‚å¹¶æ¯éš” `interval` ç§’é‡æ–°æ‰«æä¸€æ¬¡ã€‚

> [!SUCCESS]
> **ç°ä»£åŒ–å·¥ä½œæµç¨‹**ï¼š
> 1. é…ç½®å¥½ `credential` å’ŒåŸºæœ¬è®¾ç½®
> 2. å¯åŠ¨ç¨‹åº
> 3. è®¿é—® `http://127.0.0.1:12345` Web ç•Œé¢
> 4. é€šè¿‡ç•Œé¢æ·»åŠ å’Œç®¡ç†è§†é¢‘æº
> 5. äº«å—è‡ªåŠ¨ä¸‹è½½æœåŠ¡ï¼

å¦‚æœä½ å¸Œæœ›äº†è§£æ›´è¯¦ç»†çš„é…ç½®é¡¹è¯´æ˜ï¼Œå¯ä»¥æŸ¥è¯¢[è¿™é‡Œ](/configuration)ã€‚
